{"version":3,"sources":["webpack:///./src/views/article/info.vue?5f2b","webpack:///./src/components/date.vue?ada7","webpack:///src/components/date.vue","webpack:///./src/components/date.vue?aaba","webpack:///./src/components/date.vue","webpack:///./src/views/article/info.vue?2b0f","webpack:///src/views/article/info.vue","webpack:///./src/views/article/info.vue?054f","webpack:///./src/views/article/info.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","model","value","callback","$$v","expression","staticRenderFns","props","watch","val","$emit","originalDate","JSON","stringify","component","directives","name","rawName","modifiers","staticClass","_v","data","$set","ref","on","change","$imgAdd","$imgDel","time","getDate","_e","uploadToggle","music","image","musicUpload","url","_s","imgUpload","submit","components","date","mavonEditor","title","content","contentHtml","describe","hide","isReset","id","upload","fullscreenLoading","loading","$route","query","loadData","computed","methods","file","uploads","type","raw","includes","$message","error","formData","FormData","append","$data","info","upload_type","URL","createObjectURL","pos","$file","formdata","$http","post","then","res","$refs","md","$img2Url","words","length","map","i","result","status","slice","_id","mesg","email","web_name","web_address","setTimeout","message","$router","push","$infoUpdate","$loading","target","get","body","$nextTick","close"],"mappings":"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","file":"js/chunk-1f1e6282.6f9d6af6.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./info.vue?vue&type=style&index=0&id=02d8f276&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-date-picker',{attrs:{\"placeholder\":\"选择日期时间\",\"type\":\"datetime\",\"value-format\":\"yyyy/MM/dd HH:mm\"},model:{value:(_vm.value),callback:function ($$v) {_vm.value=$$v},expression:\"value\"}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <el-date-picker\n      v-model=\"value\"\n      placeholder=\"选择日期时间\"\n      type=\"datetime\"\n      value-format=\"yyyy/MM/dd HH:mm\"\n  >\n  </el-date-picker>\n</template>\n\n<script>\nexport default {\n  props: ['originalDate'],\n  data() {\n    return {\n      value: '',\n    }\n  },\n  watch: {\n    value(val) {\n      this.$emit('getDate', val)\n    }\n  },\n  mounted() {\n    // 默认时间\n    if (this.originalDate && JSON.stringify(this.originalDate) != '{}') {\n      this.value = this.originalDate\n    }\n  }\n}\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./date.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./date.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./date.vue?vue&type=template&id=e80cf54c&\"\nimport script from \"./date.vue?vue&type=script&lang=js&\"\nexport * from \"./date.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"loading\",rawName:\"v-loading.fullscreen.lock\",value:(_vm.fullscreenLoading),expression:\"fullscreenLoading\",modifiers:{\"fullscreen\":true,\"lock\":true}}],staticClass:\"article-new\"},[_c('section',[_c('h2',{staticClass:\"tit\"},[_vm._v(\"无人问津的心情，在黑纸白字间游荡！\")]),_c('el-input',{attrs:{\"clearable\":\"\",\"placeholder\":\"标题\"},model:{value:(_vm.data.title),callback:function ($$v) {_vm.$set(_vm.data, \"title\", $$v)},expression:\"data.title\"}})],1),_c('mavon-editor',{ref:\"md\",attrs:{\"ishljs\":true,\"subfield\":false},on:{\"change\":_vm.change,\"imgAdd\":_vm.$imgAdd,\"imgDel\":_vm.$imgDel},model:{value:(_vm.data.content),callback:function ($$v) {_vm.$set(_vm.data, \"content\", $$v)},expression:\"data.content\"}}),_c('section',[(_vm.isReset)?_c('date',{attrs:{\"originalDate\":_vm.data.time},on:{\"getDate\":_vm.getDate}}):_vm._e(),_c('el-input',{attrs:{\"clearable\":\"\",\"placeholder\":\"文章摘要\",\"prefix-icon\":\"el-icon-document\"},model:{value:(_vm.data.describe),callback:function ($$v) {_vm.$set(_vm.data, \"describe\", $$v)},expression:\"data.describe\"}}),(!_vm.uploadToggle)?_c('div',{staticClass:\"upload-box\"},[_c('el-upload',{staticClass:\"upload-demo\",attrs:{\"auto-upload\":false,\"on-change\":_vm.musicUpload,\"show-file-list\":false,\"action\":\"\",\"drag\":\"\"}},[(_vm.data.music && _vm.data.music.url)?[_c('i',{staticClass:\"el-icon-headset\"}),_c('div',{staticClass:\"el-upload__text\"},[_vm._v(_vm._s(_vm.data['music'].name))])]:[_c('i',{staticClass:\"el-icon-headset\"}),_c('div',{staticClass:\"el-upload__text\"},[_vm._v(\"背景音乐\")])]],2),_c('el-upload',{staticClass:\"upload-demo\",attrs:{\"auto-upload\":false,\"on-change\":_vm.imgUpload,\"show-file-list\":false,\"action\":\"\",\"drag\":\"\"}},[(_vm.data.image && _vm.data.image.url)?_c('img',{attrs:{\"src\":_vm.data.image.url}}):_vm._e(),_c('i',{staticClass:\"el-icon-picture-outline-round\"}),_c('div',{staticClass:\"el-upload__text\"},[_vm._v(\"封面图片 (680*440)\")])])],1):[_c('el-input',{attrs:{\"clearable\":\"\",\"placeholder\":\"音乐地址\",\"prefix-icon\":\"el-icon-headset\"},model:{value:(_vm.data.music.url),callback:function ($$v) {_vm.$set(_vm.data.music, \"url\", $$v)},expression:\"data.music.url\"}}),_c('el-input',{attrs:{\"clearable\":\"\",\"placeholder\":\"封面图片\",\"prefix-icon\":\"el-icon-picture-outline-round\"},model:{value:(_vm.data.image.url),callback:function ($$v) {_vm.$set(_vm.data.image, \"url\", $$v)},expression:\"data.image.url\"}})],_c('el-switch',{attrs:{\"active-text\":\"输入链接\",\"inactive-text\":\"文件上传\"},model:{value:(_vm.uploadToggle),callback:function ($$v) {_vm.uploadToggle=$$v},expression:\"uploadToggle\"}}),_c('el-switch',{attrs:{\"active-text\":\"隐藏文章\",\"inactive-text\":\"发布文章\"},model:{value:(_vm.data.hide),callback:function ($$v) {_vm.$set(_vm.data, \"hide\", $$v)},expression:\"data.hide\"}})],2),_c('el-button',{staticClass:\"submit\",attrs:{\"type\":\"primary\"},on:{\"click\":_vm.submit}},[_vm._v(\"SUBMIT\")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div v-loading.fullscreen.lock=\"fullscreenLoading\" class=\"article-new\">\n\n    <section>\n      <h2 class=\"tit\">无人问津的心情，在黑纸白字间游荡！</h2>\n      <el-input\n          v-model=\"data.title\"\n          clearable\n          placeholder=\"标题\">\n      </el-input>\n    </section>\n\n    <mavon-editor\n        ref=\"md\"\n        v-model=\"data.content\"\n        :ishljs=\"true\"\n        :subfield=\"false\"\n        @change=\"change\"\n        @imgAdd=\"$imgAdd\"\n        @imgDel=\"$imgDel\"\n    />\n\n    <section>\n      <date\n          v-if=\"isReset\"\n          :originalDate=\"data.time\"\n          @getDate=\"getDate\"\n      ></date>\n      <el-input\n          v-model=\"data.describe\"\n          clearable\n          placeholder=\"文章摘要\"\n          prefix-icon=\"el-icon-document\">\n      </el-input>\n\n      <div v-if=\"!uploadToggle\" class=\"upload-box\">\n        <el-upload\n            :auto-upload=\"false\"\n            :on-change=\"musicUpload\"\n            :show-file-list=\"false\"\n            action=\"\"\n            class=\"upload-demo\"\n            drag\n        >\n          <template v-if=\"data.music && data.music.url\">\n            <i class=\"el-icon-headset\"></i>\n            <div class=\"el-upload__text\">{{ data['music'].name }}</div>\n          </template>\n          <template v-else>\n            <i class=\"el-icon-headset\"></i>\n            <div class=\"el-upload__text\">背景音乐</div>\n          </template>\n        </el-upload>\n        <el-upload\n            :auto-upload=\"false\"\n            :on-change=\"imgUpload\"\n            :show-file-list=\"false\"\n            action=\"\"\n            class=\"upload-demo\"\n            drag\n        >\n          <img v-if=\"data.image && data.image.url\" :src=\"data.image.url\">\n          <i class=\"el-icon-picture-outline-round\"></i>\n          <div class=\"el-upload__text\">封面图片 (680*440)</div>\n        </el-upload>\n      </div>\n      <template v-else>\n        <el-input\n            v-model=\"data.music.url\"\n            clearable\n            placeholder=\"音乐地址\"\n            prefix-icon=\"el-icon-headset\">\n        </el-input>\n        <el-input\n            v-model=\"data.image.url\"\n            clearable\n            placeholder=\"封面图片\"\n            prefix-icon=\"el-icon-picture-outline-round\">\n        </el-input>\n      </template>\n\n      <el-switch\n          v-model=\"uploadToggle\"\n          active-text=\"输入链接\"\n          inactive-text=\"文件上传\"\n      >\n      </el-switch>\n\n      <el-switch\n          v-model=\"data.hide\"\n          active-text=\"隐藏文章\"\n          inactive-text=\"发布文章\">\n      </el-switch>\n    </section>\n\n    <el-button class=\"submit\" type=\"primary\" @click=\"submit\">SUBMIT</el-button>\n  </div>\n</template>\n\n<script>\nimport date from '@/components/date'\nimport {mapState} from 'vuex'\nimport {mavonEditor} from 'mavon-editor'\nimport 'mavon-editor/dist/css/index.css'\n\nexport default {\n  components: {\n    date,\n    mavonEditor\n  },\n  data() {\n    return {\n      data: {\n        title: '',              // 标题\n        content: '',            // 内容\n        contentHtml: '',        // 内容解析html\n        describe: '',           // 文章摘要\n        time: '',               // 时间\n        image: {},              // 图片\n        music: {},              // 音乐\n        hide: false,            // 隐藏\n      },\n      isReset: true,\n      id: '',                     // 当前文章id（编辑）\n\n      upload: {},\n      uploadToggle: false,\n\n      fullscreenLoading: false,\n      loading: ''\n    }\n  },\n  created() {\n    this.id = this.$route.query.id;\n    if (this.id) this.loadData(this.id);\n  },\n  watch: {\n    'data.image.url': {\n      handler(val) {\n        if (!val) {\n          delete this.upload['image']\n        }\n      }\n    },\n    'data.music.url': {\n      handler(val) {\n        if (!val) {\n          delete this.upload['music']\n        }\n      }\n    }\n  },\n  computed: {\n    ...mapState(['$data'])\n  },\n  methods: {\n    musicUpload(file) {\n      this.uploads('music', file)\n    },\n    imgUpload(file) {\n      this.uploads('image', file)\n    },\n    // 保存临时文件\n    uploads(type, file) {\n      const name = type == 'music' ? 'audio' : 'image';\n      if (!file.raw.type.includes(name)) {\n        this.$message.error(`请选择${name}格式的文件!`)\n        return\n      }\n      const formData = new FormData();\n      formData.append('file', file.raw);\n      formData.append('type', this.$data.info.upload_type);\n\n      this.$set(this.data, type, {\n        url: URL.createObjectURL(file.raw),\n        name: file.name\n      })\n\n      this.$set(this.upload, type, {\n        url: URL.createObjectURL(file.raw),\n        name: file.name,\n        formData\n      })\n    },\n    $imgAdd(pos, $file) {\n      var formdata = new FormData();\n      formdata.append('file', $file);\n      formdata.append('type', this.$data.info.upload_type);\n\n      this.$http.post('/upload', formdata).then(res => {\n        this.$refs.md.$img2Url(pos, res.data.url);\n      })\n    },\n    $imgDel(pos) {\n      const data = {\n        url: pos[0],\n        type: this.$data.info.upload_type\n      }\n      this.$http.post('/delete_file', data)\n    },\n    change(value, render) {\n      this.data.contentHtml = render;     // 解析的html\n      this.data.content = value;          // 输入的内容\n      this.data.words = value.length;     // 字数\n    },\n    async submit() {\n      const map = {\n        'title': '请输入标题',\n        'content': '请输入内容',\n        'time': '请选择时间',\n      }\n      for (let i in map) {\n        if (!this.data[i]) {\n          this.$message.error(`${map[i]}`);\n          return;\n        }\n      }\n\n      this.fullscreenLoading = true;\n\n      // 上传文件\n      if (!this.uploadToggle) {\n        for (let i in this.upload) {\n          const result = await this.$http.post('/upload', this.upload[i].formData);\n          if (result.data.status == 100) {\n            this.data[i].url = result.data.url;\n          } else {\n            // 错误\n            this.$message.error('图片上传失败, 请检查网络!');\n            this.fullscreenLoading = false;\n          }\n        }\n      }\n\n      // 摘要默认内容\n      const describe = this.data.describe;\n      this.data.describe = !describe ? this.data.content.slice(0, 60) + '...' : describe;\n\n      const type = this.id ? `article/${this.data._id}` : 'article';\n      const mesg = this.id ? '更新' : '发表';\n\n      // 网站和管理员的信息\n      const email = this.$data.info['email']\n      email.web_name = this.$data.info['web_name']\n      email.web_address = this.$data.info['address']\n\n      this.$http.post(type, {data: this.data, email}).then(res => {\n        setTimeout(() => {\n          if (res.data.status === 1) {\n            this.$message({\n              message: `${mesg}成功`,\n              type: 'success'\n            });\n            this.$router.push('/article')\n            this.$infoUpdate() // 刷新状态\n          } else {\n            this.$message.error(`${mesg}失败，请检查网络问题!`);\n          }\n          this.fullscreenLoading = false;\n        }, 500)\n      })\n    },\n    // 获取时间\n    getDate(val) {\n      this.data.time = val;\n    },\n    // 获取当前文章的数据\n    async loadData(id) {\n\n      this.loading = this.$loading({target: '.container'})\n\n      const res = await this.$http.get(`article/${id}`)\n\n      setTimeout(() => {\n        this.data = res.data.body;\n        this.isReset = false;\n        this.$nextTick(() => {\n          this.isReset = true;\n        })\n        this.loading.close()\n      }, 500)\n    },\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\nsection {\n  margin: 15px 0;\n\n  .el-switch, .el-input {\n    width: 100%;\n    height: 38px;\n    margin: 8px 0;\n  }\n}\n\n.markdown-body {\n  height: 65vh;\n  box-shadow: none !important;\n  border: 1px solid #eee !important;\n}\n\n.submit {\n  width: 200px;\n  height: 40px;\n  font-size: 14px;\n  color: #fff;\n}\n\n.upload-box {\n  display: flex;\n  margin: 10px -7px 6px;\n\n  .upload-demo {\n    width: 50%;\n    max-width: 360px;\n    margin: 0 7px;\n\n    /deep/ .el-upload {\n      width: 100%;\n\n      .el-upload-dragger {\n        width: 100%;\n\n        .el-icon-picture-outline-round,\n        .el-icon-headset {\n          font-size: 46px;\n          color: #c0c4cc;\n          margin: 42px 0 14px;\n          line-height: 50px;\n          transition: all .3s;\n        }\n\n        .el-upload__text {\n          color: #98999c;\n          transition: all .3s;\n        }\n\n        &:hover {\n          .el-icon-picture-outline-round,\n          .el-upload__text,\n          .el-icon-headset {\n            color: #409EFF;\n          }\n        }\n      }\n    }\n  }\n\n  img {\n    width: 100%;\n  }\n}\n\n/deep/ .el-switch__label {\n  color: #98999c;\n  font-weight: 400;\n\n  &.is-active {\n    color: #409EFF;\n  }\n}\n\n@media screen and (max-width: 600px) {\n  .markdown-body {\n    height: 90vh !important;\n    box-shadow: none !important;\n  }\n  section {\n    margin: 10px 0;\n    box-shadow: none;\n  }\n  .submit {\n    width: 150px;\n    height: 36px;\n    margin: 0 0 20px;\n    line-height: 36px;\n    padding: 0;\n  }\n  .upload-box .upload-demo /deep/ .el-upload .el-upload-dragger {\n    height: 130px;\n\n    .el-icon-picture-outline-round, .el-icon-headset {\n      font-size: 36px;\n      margin: 22px 0 10px;\n    }\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./info.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./info.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./info.vue?vue&type=template&id=02d8f276&scoped=true&\"\nimport script from \"./info.vue?vue&type=script&lang=js&\"\nexport * from \"./info.vue?vue&type=script&lang=js&\"\nimport style0 from \"./info.vue?vue&type=style&index=0&id=02d8f276&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"02d8f276\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}